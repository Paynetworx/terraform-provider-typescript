package typescript

import (
	"fmt"
	"testing"

	r "github.com/hashicorp/terraform/helper/resource"
	"github.com/hashicorp/terraform/terraform"
)

const templateTypescriptNodeModulesConfig = `
resource "typescript_node_modules" "handler" {
	source = "%s"
	build_docker_image = "amazon/aws-lambda-nodejs:latest"
}`


func TestNodeModules(t *testing.T) {
	var cases = []struct {
		file string
	}{
		{
			file: `_testdata/package.json`,
		},
	}
	dsn:="typescript_node_modules.handler"
	for _, tt := range cases {
		// Run test case.
		r.UnitTest(t, r.TestCase{
			Providers: testProviders,
			Steps: []r.TestStep{
				{
					Config: fmt.Sprintf(templateTypescriptNodeModulesConfig, tt.file),
					Check: r.ComposeTestCheckFunc(
						r.TestCheckResourceAttr(dsn,"output_sha","c4aef9460d4a35d2809a8d5bcbaf9aefaafe6423"),
					),
				},
			},
			CheckDestroy: func(*terraform.State) error {
				return nil
			},
		})
	}
}
